        // ===== DATA STRUCTURE AR/VR VISUALIZATION FOR PRACTICE LABS =====
        const dsVisualizationMap = {
            'arrays': { name: 'Array', color: 0x6366f1, shape: 'boxes' },
            'linked-list': { name: 'Linked List', color: 0x22c55e, shape: 'chain' },
            'tree': { name: 'Binary Tree', color: 0x0ea5e9, shape: 'tree' },
            'graph': { name: 'Graph', color: 0xf59e0b, shape: 'network' },
            'hash': { name: 'Hash Map', color: 0xef4444, shape: 'scatter' },
            'stack': { name: 'Stack', color: 0xec4899, shape: 'column' },
            'queue': { name: 'Queue', color: 0x8b5cf6, shape: 'row' }
        };

        function openDataStructureAR() {
            const questionTitle = document.getElementById('dsa-question-title')?.textContent || 'Two Sum';
            const category = document.getElementById('dsa-category')?.textContent || 'Arrays';
            const code = document.getElementById('labs-code-input')?.value || '';
            
            const dsType = category.toLowerCase().includes('array') ? 'arrays' : 
                           category.toLowerCase().includes('linked') ? 'linked-list' :
                           category.toLowerCase().includes('tree') ? 'tree' :
                           category.toLowerCase().includes('graph') ? 'graph' :
                           category.toLowerCase().includes('hash') ? 'hash' :
                           category.toLowerCase().includes('stack') ? 'stack' :
                           category.toLowerCase().includes('queue') ? 'queue' : 'arrays';
            
            const dsInfo = dsVisualizationMap[dsType];
            
            const overlay = document.createElement('div');
            overlay.id = 'ds-ar-overlay';
            overlay.style.cssText = 'position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:10001; display:flex; flex-direction:column; justify-content:space-between; padding:20px; font-family: sans-serif;';
            overlay.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2 style="color:#e5e7eb; font-size:22px; margin:0; display:flex; gap:8px; align-items:center;">
                        üï∂Ô∏è ${dsInfo.name} AR Visualization - ${questionTitle}
                    </h2>
                    <button id="close-ds-ar" style="background:#ef4444; color:#fff; border:none; padding:10px 20px; border-radius:10px; cursor:pointer; font-weight:600;">Close AR</button>
                </div>
                <div style="flex:1; display:grid; grid-template-columns:1fr 1fr; gap:20px; align-items:center; margin:20px 0;">
                    <div id="ds-ar-container" style="background:#111827; border:2px solid #334155; border-radius:12px; position:relative; height:100%;">
                        <canvas id="ds-ar-canvas" style="width:100%; height:100%; display:block; border-radius:10px;"></canvas>
                    </div>
                    <div style="background:#0f172a; border:1px solid #1f2937; border-radius:12px; padding:20px; color:#cbd5e1; height:100%; overflow-y:auto;">
                        <h3 style="margin:0 0 12px 0; color:#e5e7eb;">${dsInfo.name} Visualization</h3>
                        <p style="margin:0 0 12px 0; font-size:13px; color:#9ca3af;">This AR/VR view shows how ${dsInfo.name.toLowerCase()} works with your code.</p>
                        <div style="background:#1e293b; padding:12px; border-radius:8px; margin-bottom:12px;">
                            <p style="margin:0 0 8px 0; font-size:12px; font-weight:600;">Code Snippet:</p>
                            <pre style="margin:0; background:#0f172a; padding:8px; border-radius:6px; color:#10b981; font-size:11px; overflow-x:auto; white-space:pre-wrap; word-wrap:break-word; max-height:80px;">${code.substring(0, 200)}...</pre>
                        </div>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:12px;">
                            <button onclick="rotateDS3DLeft()" style="background:#0ea5e9; color:#fff; border:none; padding:8px; border-radius:8px; cursor:pointer; font-size:12px; font-weight:600;">‚Ü∂ Rotate</button>
                            <button onclick="zoomDS3DIn()" style="background:#22c55e; color:#0b172a; border:none; padding:8px; border-radius:8px; cursor:pointer; font-size:12px; font-weight:700;">üîç Zoom</button>
                        </div>
                        <div style="padding:12px; background:#1e293b; border-radius:8px; border-left:3px solid #555;">
                            <p style="margin:0;font-size:12px;color:#cbd5e1;line-height:1.6;">
                                <strong>Type:</strong> ${dsInfo.name}<br>
                                <strong>Shape:</strong> ${dsInfo.shape}<br>
                                <strong>Color:</strong> ${dsInfo.color}
                            </p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(overlay);
            
            const closeBtn = overlay.querySelector('#close-ds-ar');
            closeBtn.onclick = () => overlay.remove();
            
            initDS3DVisualization(dsType, dsInfo.color);
        }

        function initDS3DVisualization(dsType, color) {
            const canvas = document.getElementById('ds-ar-canvas');
            if (!canvas) return;
            
            window.dsScene = new THREE.Scene();
            window.dsCamera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            window.dsRenderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
            window.dsRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
            window.dsRenderer.setClearColor(0x111827, 1);
            
            window.dsCamera.position.z = 6;
            
            const light = new THREE.PointLight(0xffffff, 1.2);
            light.position.set(8, 8, 8);
            window.dsScene.add(light);
            
            const ambientLight = new THREE.AmbientLight(0x404040, 0.8);
            window.dsScene.add(ambientLight);
            
            createDSGeometry(dsType, color);
            
            let animationId;
            const animate = () => {
                animationId = requestAnimationFrame(animate);
                
                window.dsScene.children.forEach(child => {
                    if (child instanceof THREE.Mesh && child.userData.rotateX !== undefined) {
                        child.rotation.x += child.userData.rotateX || 0.002;
                        child.rotation.y += child.userData.rotateY || 0.003;
                    }
                });
                
                window.dsRenderer.render(window.dsScene, window.dsCamera);
            };
            animate();
            
            window.dsAnimationId = animationId;
            
            window.addEventListener('resize', () => {
                const rect = canvas.getBoundingClientRect();
                window.dsRenderer.setSize(rect.width, rect.height);
                window.dsCamera.aspect = rect.width / rect.height;
                window.dsCamera.updateProjectionMatrix();
            });
        }

        function createDSGeometry(dsType, baseColor) {
            if (dsType === 'arrays') {
                for (let i = 0; i < 5; i++) {
                    const geom = new THREE.BoxGeometry(0.8, 0.8, 0.8);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.x = (i - 2) * 1.2;
                    mesh.userData.rotateX = 0.003;
                    mesh.userData.rotateY = 0.005;
                    window.dsScene.add(mesh);
                }
            } else if (dsType === 'linked-list') {
                for (let i = 0; i < 4; i++) {
                    const geom = new THREE.SphereGeometry(0.4, 32, 32);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.x = (i - 1.5) * 2;
                    mesh.userData.rotateX = 0.002;
                    mesh.userData.rotateY = 0.004;
                    window.dsScene.add(mesh);
                    
                    if (i < 3) {
                        const lineGeom = new THREE.BufferGeometry();
                        const points = [
                            new THREE.Vector3((i - 1.5) * 2 + 0.4, 0, 0),
                            new THREE.Vector3((i - 0.5) * 2 - 0.4, 0, 0)
                        ];
                        lineGeom.setFromPoints(points);
                        const lineMat = new THREE.LineBasicMaterial({ color: baseColor });
                        window.dsScene.add(new THREE.Line(lineGeom, lineMat));
                    }
                }
            } else if (dsType === 'tree') {
                const createNode = (x, y, depth) => {
                    if (depth > 2) return;
                    const geom = new THREE.SphereGeometry(0.3, 32, 32);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.set(x, y, 0);
                    mesh.userData.rotateX = 0.002;
                    mesh.userData.rotateY = 0.003;
                    window.dsScene.add(mesh);
                    
                    if (depth < 2) {
                        const nextY = y - 1.5;
                        const offset = 2 / Math.pow(2, depth + 1);
                        createNode(x - offset, nextY, depth + 1);
                        createNode(x + offset, nextY, depth + 1);
                    }
                };
                createNode(0, 1.5, 0);
            } else if (dsType === 'hash') {
                for (let i = 0; i < 8; i++) {
                    const geom = new THREE.SphereGeometry(0.3, 32, 32);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.set(Math.random() * 4 - 2, Math.random() * 4 - 2, 0);
                    mesh.userData.rotateX = 0.005;
                    mesh.userData.rotateY = 0.005;
                    window.dsScene.add(mesh);
                }
            } else if (dsType === 'stack') {
                for (let i = 0; i < 4; i++) {
                    const geom = new THREE.BoxGeometry(1, 0.6, 0.6);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.y = (i - 1.5) * 0.9;
                    mesh.userData.rotateX = 0.003;
                    mesh.userData.rotateY = 0.004;
                    window.dsScene.add(mesh);
                }
            } else if (dsType === 'queue') {
                for (let i = 0; i < 4; i++) {
                    const geom = new THREE.BoxGeometry(0.6, 1, 0.6);
                    const mat = new THREE.MeshPhongMaterial({ color: baseColor });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.position.x = (i - 1.5) * 0.9;
                    mesh.userData.rotateX = 0.003;
                    mesh.userData.rotateY = 0.004;
                    window.dsScene.add(mesh);
                }
            }
        }

        function rotateDS3DLeft() {
            if (window.dsCamera) {
                window.dsCamera.position.x -= 2;
            }
        }

        function zoomDS3DIn() {
            if (window.dsCamera) {
                window.dsCamera.position.z -= 1;
            }
        }
